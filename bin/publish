#!/usr/bin/env bash
set -e
set -v

switch() {
  git checkout $1 2>/dev/null || git checkout -b $1
}

# modified from: https://gist.github.com/SangsooNam/aa73c3e1ff88d30433e4020f1275242a

gitbook install && gitbook build
switch gh-pages
git pull origin gh-pages --rebase
cp -R _book/* .
git add .
git commit -a -m "published $(date +%Y%m%d%H%M%S)"
git push origin gh-pages
git checkout master
